{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/medf-v0.1.schema.json",
  "title": "MeDF (Meaning-anchored Document Format) v0.1",
  "description": "A document format for stable, meaning-based citation and reuse of documents",
  "type": "object",
  "required": ["medf", "id", "snapshot", "hash", "authority", "content"],
  "properties": {
    "medf": {
      "type": "string",
      "pattern": "^1\\.0$",
      "description": "MeDF format version"
    },
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9-/]*[a-z0-9]$",
      "minLength": 1,
      "maxLength": 255,
      "description": "Unique document identifier (without 'medf:' prefix)"
    },
    "snapshot": {
      "type": "string",
      "format": "date-time",
      "description": "Snapshot timestamp in ISO 8601 format"
    },
    "hash": {
      "type": "object",
      "required": ["algorithm", "value"],
      "properties": {
        "algorithm": {
          "type": "string",
          "enum": ["sha-256", "sha-384", "sha-512"],
          "description": "Hash algorithm used"
        },
        "value": {
          "type": "string",
          "pattern": "^[a-f0-9]+$",
          "description": "Hash value in hexadecimal format"
        }
      }
    },
    "authority": {
      "type": "string",
      "minLength": 1,
      "maxLength": 255,
      "description": "Responsible organization or individual"
    },
    "content": {
      "type": "string",
      "minLength": 1,
      "description": "Main content in Markdown format"
    },
    "index": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "Document title"
        },
        "summary": {
          "type": "object",
          "properties": {
            "short": {
              "type": "string",
              "maxLength": 200,
              "description": "One-line summary"
            },
            "medium": {
              "type": "string",
              "maxLength": 500,
              "description": "2-3 lines summary"
            },
            "full": {
              "type": "string",
              "description": "Detailed summary"
            }
          }
        },
        "sections": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "title", "level"],
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^[a-z0-9][a-z0-9-]*[a-z0-9]$"
              },
              "title": {
                "type": "string"
              },
              "level": {
                "type": "integer",
                "minimum": 1,
                "maximum": 6
              },
              "summary": {
                "type": "string"
              }
            }
          }
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "keywords": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "references": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["uri", "type"],
        "properties": {
          "uri": {
            "type": "string",
            "format": "uri"
          },
          "type": {
            "type": "string",
            "enum": ["source", "related", "citation", "supplement"]
          },
          "title": {
            "type": "string"
          },
          "retrieved": {
            "type": "string",
            "format": "date-time"
          }
        }
      }
    },
    "signature": {
      "type": "object",
      "properties": {
        "algorithm": {
          "type": "string",
          "enum": ["ES256", "ES384", "ES512", "RS256", "RS384", "RS512"],
          "description": "JWS signature algorithm"
        },
        "value": {
          "type": "string",
          "description": "JWS signature value"
        },
        "signer": {
          "type": "string",
          "description": "DID or identifier of the signer"
        }
      }
    },
    "extensions": {
      "type": "object",
      "description": "Custom extension fields (not included in hash calculation)"
    }
  }
}
